var ststmr=null,my_chart=null,temp_data=[],output_data=[],setpoint_data=[];function gettemp(){$.getJSON("/get_temp.json",function(t){$("#temp").val(t.temp),$("#output").val(t.output),temp_data.push(t.temp),output_data.push(t.output),setpoint_data.push(t.setpoint),my_chart&&my_chart.update()})}function updatefw(){$.getJSON("/get_fw.json",function(t){$("#lblsetpoint").text("Setpoint \xbaC ("+t.temp_min+"~"+t.temp_max+")"),$("#setpoint").attr({min:t.temp_min,max:t.temp_max}),$("#setpoint").val(t.setpoint),$("#kp").val(t.kp),$("#ki").val(t.ki),$("#kd").val(t.kd)})}function updateinfo(){gettemp(),null==ststmr&&(ststmr=setInterval(updateinfo,5e3))}function createchart(){let t=document.getElementById("myChart");my_chart=new Chart(t,{type:"line",data:{labels:["t","t"],datasets:[{label:"Temperatura",data:temp_data},{label:"Setpoint",data:setpoint_data}]},options:{responsive:!0,plugins:{legend:{position:"top"}}}})}function setpid(t){!0==confirm("Enviar nova configura\xe7\xe3o PID?")&&$.ajax({url:"/set_pid.json",dataType:"json",method:"POST",cache:!1,data:JSON.stringify(t),success:function(t){"ok"==JSON.parse(JSON.stringify(t)).status?alert("Ok"):alert("Erro nos dados")},error:function(){alert("N\xe3o foi poss\xedvel enviar a solicita\xe7\xe3o")}})}function form2json(t){return $(t).serializeArray().reduce(function(t,{name:e,value:a}){return t[e]=a,t},{})}$(document).ready(function(){createchart(),updatefw(),updateinfo(),$("#form_pid").on("submit",function(t){return t.preventDefault(),setpid(form2json($(t.target))),!0})});